<?php
// –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º –Ω–∞ WebAuthn

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
function isMobileDevice() {
    $userAgent = $_SERVER['HTTP_USER_AGENT'] ?? '';
    return preg_match('/iPhone|iPad|iPod|Android|Mobile|BlackBerry|Opera Mini/i', $userAgent);
}

$isMobile = isMobileDevice();
?>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAuthn - –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <div class="fingerprint">üîê</div>
        <h1>WebAuthn Demo</h1>
        <p class="welcome-text">
            –°–∏—Å—Ç–µ–º–∞ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏<br>
            —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ç–ø–µ—á–∞—Ç–∫–∞ –ø–∞–ª—å—Ü–∞ –∏–ª–∏ Face ID
        </p>

        <?php if ($isMobile): ?>
            <div class="status-card status-success">
                <strong>‚úÖ –ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</strong>
                <p>–ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...</p>
            </div>
            <div class="loading" id="redirectMessage">
                –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ <span id="countdown">3</span> —Å–µ–∫—É–Ω–¥...
            </div>
            <a href="webauthn.html" class="btn" id="manualLink">
                –ü–µ—Ä–µ–π—Ç–∏ –∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            </a>
        <?php else: ?>
            <div class="status-card status-error">
                <strong>‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</strong>
                <p>–î–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Ç–æ–ª—å–∫–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.</p>
            </div>
            <div class="status-card status-warning">
                <strong>üì± –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø:</strong>
                <ul style="text-align: left; margin: 10px 0;">
                    <li>–û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–æ—Ç —Å–∞–π—Ç –Ω–∞ iPhone –∏–ª–∏ Android</li>
                    <li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —ç–∫—Ä–∞–Ω–∞</li>
                    <li>–†–∞–∑—Ä–µ—à–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–æ–º–µ—Ç—Ä–∏—é</li>
                </ul>
            </div>
        <?php endif; ?>
    </div>

    <?php if ($isMobile): ?>
    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        let countdown = 3;
        const countdownElement = document.getElementById('countdown');
        
        const timer = setInterval(() => {
            countdown--;
            countdownElement.textContent = countdown;
            
            if (countdown <= 0) {
                clearInterval(timer);
                window.location.href = 'webauthn.html';
            }
        }, 1000);
        
        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å—Å—ã–ª–∫—É
        document.getElementById('manualLink').addEventListener('click', () => {
            clearInterval(timer);
        });
    </script>
    <?php endif; ?>
</body>
</html>